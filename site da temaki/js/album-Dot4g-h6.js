let t=window.albumImages||[],f=window.albumDescriptions||[],r=document.getElementById("imageModal"),p=document.getElementById("modalImage"),v=document.getElementById("closeBtn"),o=document.getElementById("prevBtn"),a=document.getElementById("nextBtn"),g=document.getElementById("progressContainer"),h=null,l=[],i=0;function E(e){if(!t||t.length===0)return;i=Math.max(0,Math.min(e,t.length-1)),p.src=t[i];let n=document.getElementById("imageDescription"),s=f[i];s&&typeof s=="object"?n.textContent=s.description||"":n.textContent="",n.textContent.trim()!==""?n.classList.remove("hidden"):n.classList.add("hidden"),r.classList.remove("hidden"),x(),y(),c()}function L(e){(!e||e.target===r||e.target===v||e.target.closest("#closeBtn"))&&(r.classList.add("hidden"),d())}function u(){!t||t.length===0||(d(),i=(i+1)%t.length,I(),c())}function w(){!t||t.length===0||(d(),i=(i-1+t.length)%t.length,I(),c())}function I(){if(!t||t.length===0||!t[i]){r.classList.add("hidden");return}p.src=t[i];let e=document.getElementById("imageDescription"),n=f[i];typeof n=="string"?e.textContent=n:n&&typeof n=="object"&&n.description?e.textContent=n.description:e.textContent="",e.textContent.trim()!==""?e.classList.remove("hidden"):e.classList.add("hidden"),B(),y()}function y(){o.disabled=!1,a.disabled=!1,o.classList.remove("opacity-50","cursor-not-allowed"),a.classList.remove("opacity-50","cursor-not-allowed"),t.length<=1&&(o.disabled=!0,a.disabled=!0,o.classList.add("opacity-50","cursor-not-allowed"),a.classList.add("opacity-50","cursor-not-allowed"))}function c(){!t||t.length===0||(d(),B(),h=setInterval(()=>{u()},5e3))}function d(){clearInterval(h)}function x(){g.innerHTML="",l=t.map((e,n)=>{const s=document.createElement("div");s.className="h-1 flex-1 bg-gray-600 rounded-full overflow-hidden relative";const m=document.createElement("div");return m.className="h-full bg-white w-0 absolute left-0 top-0 transition-all duration-[5s] ease-linear",s.appendChild(m),g.appendChild(s),m}),l[i]&&(l[i].style.width="100%")}function B(){l.forEach((e,n)=>{e.classList.remove("transition-all","duration-[5s]","ease-linear"),e.style.width="0%"}),setTimeout(()=>{l.forEach(e=>{e.classList.add("transition-all","duration-[5s]","ease-linear")}),l[i]&&(l[i].style.width="100%")},50)}o.addEventListener("click",w);a.addEventListener("click",u);document.addEventListener("visibilitychange",()=>{document.hidden?d():c()});window.showImage=E;window.closeModal=L;window.nextImage=u;window.prevImage=w;
